{"version":3,"sources":["utils/covid19API.js","redux/sagas/index.js","redux/reducers/covid19Reducer.js","redux/reducers/index.js","redux/index.js","i18n/locales/index.js","styles/App.js","styles/Main.js","styles/MapLegend.js","components/mapLegend/MapLegend.js","components/main/Main.js","App.js","AppIntlWrapper.js","styles/Index.js","serviceWorker.js","index.js"],"names":["parsedData","fetchCovid19Data","Promise","resolve","reject","response","readRemoteFile","header","complete","results","by_province_date","buildCasesByProvinceDate","last_14_by_province","buildLast14Days","error","data","result","forEach","row","date","ine_code","province","dateMinus1","moment","subtract","format","currentAccumulated","parseInt","cases_accumulated","isNaN","lastDate","getLastUpdateDate","Object","keys","name","accumulated","i","currentDate","new_cases","Error","length","fetchCovidData","covid19DataSaga","call","covid19Data","put","type","payload","message","takeEvery","initialState","lastUpdateDate","noDataProvinces","rootReducer","combineReducers","covid19","state","action","sagaMiddleware","createSagaMiddleware","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","run","covid19Sagas","en","es","AppWrapper","styled","div","MainWrapper","MapLegendWrapper","messages","defineMessages","legendTitle","id","defaultMessage","legendRed","legendYellow","legendGreen","legendBlack","dataSource","injectIntl","props","formatMessage","intl","className","a","msg","target","href","provincePopup","noData","Main","lat","lng","zoom","openLegend","geoJSONStyle","feature","last14ByProvince","color","weight","fillOpacity","fillColor","getColor","properties","cartodb_id","onEachFeature","layer","popupContent","includes","bindPopup","onMenuClick","setState","closeLegend","dispatch","this","provinceCode","cases","isMobile","Map","center","onMove","onClick","onZoom","TileLayer","attribution","url","GeoJSON","spainProvinces","style","List","Component","connect","title","updateDate","App","isLandscape","Loop","withOrientationChange","AppIntlWrapper","locale","location","search","replace","translations","key","GlobalStyle","createGlobalStyle","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","console"],"mappings":"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","file":"static/js/main.2b39e1c1.chunk.js","sourcesContent":["import { readRemoteFile } from 'react-papaparse';\nimport moment from 'moment';\n\nconst DATA_URL =\n  'https://raw.githubusercontent.com/montera34/escovid19data/master/data/output/covid19-provincias-spain_consolidated.csv';\nlet parsedData;\n\n/**\n * Fetch CSV data from repository and builds data for map.\n * @returns {Promise<Object>}\n */\nexport const fetchCovid19Data = () =>\n  new Promise((resolve, reject) => {\n    const response = {};\n    readRemoteFile(DATA_URL, {\n      header: true,\n      complete: (results) => {\n        parsedData = results;\n        // console.log('Results:', results);\n        response.by_province_date = buildCasesByProvinceDate(results);\n        response.last_14_by_province = buildLast14Days(\n          response.by_province_date\n        );\n        resolve(response);\n      },\n      error: reject,\n    });\n  });\n\n/**\n * Build an object of this format:\n * {\n *   ine_code: {\n *     name: String,\n *     date1: {\n *       accumulated: Number,\n *       new_cases: Number\n *     },\n *     date2: {\n *       accumulated: Number,\n *       new_cases: Number\n *     },\n *     ...\n *   }\n * }\n * @param data Object from readRemoteFile call.\n * @returns {Object}\n */\nconst buildCasesByProvinceDate = (data) => {\n  const result = {};\n\n  data.data.forEach((row) => {\n    if (row.date) {\n      if (!result[row.ine_code]) {\n        result[row.ine_code] = {};\n        result[row.ine_code]['name'] = row.province;\n      }\n      result[row.ine_code][row.date] = {};\n\n      const dateMinus1 = moment(row.date)\n        .subtract(1, 'days')\n        .format('YYYY-MM-DD');\n\n      // Some times, accumulated can be NA, let's grab the one from the previous\n      // day or 0 if it is the first day\n      let currentAccumulated = parseInt(row.cases_accumulated, 10);\n      if (isNaN(currentAccumulated)) {\n        currentAccumulated = result[row.ine_code][dateMinus1]\n          ? result[row.ine_code][dateMinus1]['accumulated']\n          : 0;\n      }\n\n      result[row.ine_code][row.date]['accumulated'] = currentAccumulated;\n      // Calculate new cases by subtracting accumulated of the previous day\n      if (result[row.ine_code][dateMinus1]) {\n        // Current date - previous date\n        result[row.ine_code][row.date]['new_cases'] =\n          currentAccumulated - result[row.ine_code][dateMinus1]['accumulated'];\n      } else {\n        // First date\n        result[row.ine_code][row.date]['new_cases'] = currentAccumulated;\n      }\n    }\n  });\n  return result;\n};\n\n/**\n * Build an object of this format:\n * {\n *   ine_code: {\n *     name: String,\n *     accumulated: Number,\n *   },\n *   ...\n * }\n * @param data Object from {@link buildCasesByProvinceDate} method.\n * @returns {Object}\n */\nconst buildLast14Days = (data) => {\n  const result = {};\n  const lastDate = getLastUpdateDate();\n  for (let ine_code of Object.keys(data)) {\n    result[ine_code] = {\n      name: data[ine_code].name,\n      accumulated: 0,\n    };\n    // Accumulate last 15 days of new cases\n    for (let i = 0; i < 15; ++i) {\n      const currentDate = moment(lastDate)\n        .subtract(i, 'days')\n        .format('YYYY-MM-DD');\n      result[ine_code].accumulated += data[ine_code][currentDate]\n        ? data[ine_code][currentDate].new_cases\n        : 0;\n    }\n  }\n  return result;\n};\n\n/**\n * Get date of the last available data.\n * @returns {String}\n */\nexport const getLastUpdateDate = () => {\n  if (!parsedData) {\n    throw new Error('Data not parsed');\n  }\n\n  // Last row seems to be empty, let's return previous one just in case\n  return (\n    parsedData.data[parsedData.data.length - 1].date ||\n    parsedData.data[parsedData.data.length - 2].date\n  );\n};\n","import { call, put, takeEvery } from 'redux-saga/effects';\nimport { fetchCovid19Data, getLastUpdateDate } from '../../utils/covid19API';\n\nexport const FETCH_COVID19_DATA = 'FETCH_COVID19_DATA';\nexport const FETCH_COVID19_SUCCESSFUL = 'FETCH_COVID19_SUCCESSFUL';\nexport const FETCH_COVID19_FAILED = 'FETCH_COVID19_FAILED';\nexport const LAST_UPDATE_DATE = 'LAST_UPDATE_DATE';\n\nfunction* fetchCovidData() {\n  try {\n    const covid19Data = yield call(fetchCovid19Data);\n    yield put({ type: FETCH_COVID19_SUCCESSFUL, payload: covid19Data });\n    yield put({ type: LAST_UPDATE_DATE, payload: getLastUpdateDate()})\n  } catch (e) {\n    yield put({ type: FETCH_COVID19_FAILED, payload: e.message });\n  }\n}\n\nfunction* covid19DataSaga() {\n  yield takeEvery(FETCH_COVID19_DATA, fetchCovidData);\n}\n\nexport default covid19DataSaga;\n","import {\n  FETCH_COVID19_SUCCESSFUL,\n  FETCH_COVID19_FAILED,\n  LAST_UPDATE_DATE,\n} from '../sagas';\n\nconst initialState = {\n  data: {},\n  lastUpdateDate: null,\n  noDataProvinces: [15, 27, 32, 36],\n};\n\nexport const covid19 = (state = initialState, action) => {\n  switch (action.type) {\n    case FETCH_COVID19_SUCCESSFUL:\n      return { ...state, data: action.payload };\n    case FETCH_COVID19_FAILED:\n      return { ...state, data: {} };\n    case LAST_UPDATE_DATE:\n      return {\n        ...state,\n        data: { ...state.data, lastUpdateDate: action.payload },\n      };\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\n\nimport { covid19 } from './covid19Reducer';\n\nexport const rootReducer = combineReducers({ covid19 });\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\n\nimport { rootReducer } from './reducers';\nimport covid19Sagas from './sagas';\n\n// create the saga middleware\nconst sagaMiddleware = createSagaMiddleware();\n\nconst composeEnhancers =\n  (typeof window !== 'undefined' &&\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__) ||\n  compose;\n\n// mount it on the Store\nexport const store = createStore(\n  rootReducer,\n  composeEnhancers(applyMiddleware(sagaMiddleware))\n);\n\n// then run the saga\nsagaMiddleware.run(covid19Sagas);\n","import en from './en.json';\nimport es from './es.json';\n\nexport default { en, es };\n","import styled from 'styled-components';\n\nexport const AppWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n\n  p {\n    margin: 0;\n  }\n\n  @keyframes rotating {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n\n  .loading {\n    animation: rotating 2s linear infinite;\n  }\n\n  .app-header {\n    background-color: #282c34;\n    height: 50px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    font-size: 14px;\n    color: white;\n\n    h1 {\n      margin: 0 auto;\n    }\n\n    h4 {\n      margin-left: 15px;\n    }\n\n    .loading {\n      margin-left: 20px;\n    }\n\n    #languages {\n      margin-left: auto;\n      a {\n        color: #fff;\n        margin-right: 12px;\n        text-decoration: none;\n        font-weight: bold;\n\n        &:hover {\n          text-decoration: underline;\n        }\n      }\n    }\n  }\n`;\n","import styled from 'styled-components';\n\nexport const MAP_RED = '#CC0000';\nexport const MAP_YELLOW = '#FFFF00';\nexport const MAP_GREEN = '#4C9900';\n\nexport const MainWrapper = styled.div`\n  flex: 1;\n\n  .leaflet-container {\n    height: 100%;\n  }\n\n  #map-legend-wrapper {\n    position: fixed;\n    right: 25px;\n    bottom: 25px;\n    z-index: 1000;\n  }\n\n  #menu-icon {\n    position: fixed;\n    right: 25px;\n    bottom: 25px;\n    z-index: 1000;\n    background-color: #eee;\n    box-shadow: 10px 10px 50px 10px rgba(0, 0, 0, 0.3);\n    padding: 15px;\n    border: 1px solid #bbb;\n    border-radius: 4px;\n    display: none;\n  }\n\n  &.mobile-layout {\n    #map-legend-wrapper:not(.show) {\n      display: none;\n    }\n\n    #menu-icon:not(.hide) {\n      display: block;\n    }\n  }\n`;\n","import styled from 'styled-components';\n\nimport { MAP_RED, MAP_YELLOW, MAP_GREEN } from './Main';\n\nexport const MapLegendWrapper = styled.div`\n  background-color: #eee;\n  box-shadow: 10px 10px 50px 10px rgba(0, 0, 0, 0.3);\n  padding: 15px;\n  border: 1px solid #bbb;\n  border-radius: 4px;\n  display: flex;\n  flex-direction: column;\n\n  p {\n    font-size: 14px;\n    margin-bottom: 15px;\n\n    &:last-child {\n      margin-bottom: 0;\n      font-size: 12px;\n    }\n  }\n\n  & > div {\n    display: flex;\n    flex-direction: row;\n    margin-bottom: 15px;\n    font-size: 12px;\n    align-items: center;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    .color-box {\n      width: 40px;\n      height: 25px;\n      border: 1px solid #bbb;\n      border-radius: 4px;\n      margin-right: 6px;\n      opacity: 0.7;\n\n      &.red {\n        background-color: ${MAP_RED};\n      }\n\n      &.yellow {\n        background-color: ${MAP_YELLOW};\n      }\n\n      &.green {\n        background-color: ${MAP_GREEN};\n      }\n\n      &.black {\n        background-color: #000;\n      }\n    }\n  }\n`;\n","import React from 'react';\nimport { injectIntl } from 'react-intl';\nimport { defineMessages } from 'react-intl.macro';\n\nimport { MapLegendWrapper } from '../../styles/MapLegend';\n\nconst messages = defineMessages({\n  legendTitle: {\n    id: 'legend.title',\n    defaultMessage: 'Last 14 days',\n  },\n  legendRed: {\n    id: 'legend.red',\n    defaultMessage: '> 50 cases',\n  },\n  legendYellow: {\n    id: 'legend.yellow',\n    defaultMessage: '< 50 cases',\n  },\n  legendGreen: {\n    id: 'legend.green',\n    defaultMessage: '0 cases',\n  },\n  legendBlack: {\n    id: 'legend.black',\n    defaultMessage: 'Data not available',\n  },\n  dataSource: {\n    id: 'legend.source',\n    defaultMessage: 'Data source: <a>Escovid19data</a>',\n  },\n});\n\nconst MapLegend = (props) => {\n  const {\n    intl: { formatMessage },\n    className,\n  } = props;\n\n  return (\n    <MapLegendWrapper id=\"map-legend-wrapper\" className={className}>\n      <p>{formatMessage(messages.legendTitle)}</p>\n      <div>\n        <div className=\"color-box red\"></div>\n        {formatMessage(messages.legendRed)}\n      </div>\n      <div>\n        <div className=\"color-box yellow\"></div>\n        {formatMessage(messages.legendYellow)}\n      </div>\n      <div>\n        <div className=\"color-box green\"></div>\n        {formatMessage(messages.legendGreen)}\n      </div>\n      <div>\n        <div className=\"color-box black\"></div>\n        {formatMessage(messages.legendBlack)}\n      </div>\n      <p>\n        {formatMessage(messages.dataSource, {\n          a: (msg) => (\n            <a\n              target=\"_blank\"\n              href=\"https://github.com/montera34/escovid19data\"\n            >\n              {msg}\n            </a>\n          ),\n        })}\n      </p>\n    </MapLegendWrapper>\n  );\n};\n\nexport default injectIntl(MapLegend);\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { defineMessages } from 'react-intl.macro';\nimport { Map, GeoJSON, TileLayer } from 'react-leaflet';\nimport { List } from '@material-ui/icons';\nimport { isMobile } from 'react-device-detect';\n\nimport MapLegend from '../mapLegend/MapLegend';\nimport { MainWrapper, MAP_RED, MAP_YELLOW, MAP_GREEN } from '../../styles/Main';\nimport spainProvinces from '../../data/spain-provinces.json';\nimport { FETCH_COVID19_DATA } from '../../redux/sagas';\n\nconst messages = defineMessages({\n  provincePopup: {\n    id: 'main.provincePopup',\n    defaultMessage:\n      'Province: {name}<br />Accumulated cases in last 15 days: {accumulated}',\n  },\n  noData: {\n    id: 'main.noData',\n    defaultMessage: 'Province: {name}<br />,Data not available.',\n  },\n});\n\nclass Main extends Component {\n  state = {\n    lat: 37.485818,\n    lng: -5.877067,\n    zoom: 5,\n    openLegend: false,\n  };\n\n  componentDidMount() {\n    const { dispatch } = this.props;\n    dispatch({ type: FETCH_COVID19_DATA });\n  }\n\n  geoJSONStyle = (feature) => {\n    const { last_14_by_province: last14ByProvince } = this.props.data;\n\n    return {\n      color: '#1f2021',\n      weight: 1,\n      fillOpacity: 0.5,\n      fillColor: this.getColor(\n        feature.properties.cartodb_id,\n        last14ByProvince[feature.properties.cartodb_id].accumulated\n      ),\n    };\n  };\n\n  getColor(provinceCode, cases) {\n    if (this.props.noDataProvinces.includes(provinceCode)) {\n      return '#000';\n    }\n\n    if (cases >= 50) {\n      return MAP_RED;\n    } else if (cases > 0) {\n      return MAP_YELLOW;\n    }\n    return MAP_GREEN;\n  }\n\n  onEachFeature = (feature, layer) => {\n    const {\n      intl: { formatMessage },\n      data: { last_14_by_province: last14ByProvince },\n      noDataProvinces,\n    } = this.props;\n\n    const data = last14ByProvince[feature.properties.cartodb_id];\n    let popupContent = '';\n    if (noDataProvinces.includes(feature.properties.cartodb_id)) {\n      popupContent = popupContent = `<Popup><p>${formatMessage(\n        messages.noData,\n        data\n      )}</p></Popup>`;\n    } else {\n      popupContent = `<Popup><p>${formatMessage(\n        messages.provincePopup,\n        data\n      )}</p></Popup>`;\n    }\n\n    layer.bindPopup(popupContent);\n  };\n\n  onMenuClick = () => {\n    this.setState({ openLegend: true });\n  };\n\n  closeLegend = () => {\n    this.setState({ openLegend: false });\n  };\n\n  render() {\n    const { last_14_by_province: last14ByProvince } = this.props.data;\n    const { openLegend } = this.state;\n\n    return last14ByProvince ? (\n      <MainWrapper className={isMobile ? 'mobile-layout' : ''}>\n        <Map\n          center={[this.state.lat, this.state.lng]}\n          zoom={this.state.zoom}\n          onMove={this.closeLegend}\n          onClick={this.closeLegend}\n          onZoom={this.closeLegend}\n        >\n          <TileLayer\n            attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          />\n          <GeoJSON\n            data={spainProvinces}\n            style={this.geoJSONStyle}\n            onEachFeature={this.onEachFeature}\n          />\n        </Map>\n        <List\n          id=\"menu-icon\"\n          className={openLegend ? 'hide' : ''}\n          onClick={this.onMenuClick}\n        ></List>\n        <MapLegend className={openLegend ? 'show' : ''}></MapLegend>\n      </MainWrapper>\n    ) : (\n      <div></div>\n    );\n  }\n}\n\nexport default connect(({ covid19 }) => ({\n  data: covid19.data,\n  noDataProvinces: covid19.noDataProvinces,\n}))(injectIntl(Main));\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { defineMessages } from 'react-intl.macro';\nimport moment from 'moment';\nimport { AppWrapper } from './styles/App.js';\nimport Main from './components/main/Main.js';\nimport { Loop } from '@material-ui/icons';\nimport { isMobile, withOrientationChange } from 'react-device-detect';\n\nconst messages = defineMessages({\n  title: {\n    id: 'app.title',\n    defaultMessage: 'Spain Covid-19',\n  },\n  updateDate: {\n    id: 'app.updateDate',\n    defaultMessage: 'Data last update date: {lastUpdateDate}',\n  },\n});\n\nclass App extends Component {\n  render() {\n    const {\n      intl: { formatMessage },\n      lastUpdateDate,\n      isLandscape,\n    } = this.props;\n    return (\n      <AppWrapper>\n        <header className=\"app-header\">\n          {lastUpdateDate ? (\n            <h4>\n              {formatMessage(messages.updateDate, {\n                lastUpdateDate: moment(lastUpdateDate).format('DD-MM-YYYY'),\n              })}\n            </h4>\n          ) : (\n            <Loop className=\"loading\" />\n          )}\n          {(!isMobile || isLandscape) && (\n            <h1>{formatMessage(messages.title)}</h1>\n          )}\n          <div id=\"languages\">\n            <a href=\"?locale=es\">Espa√±ol</a>\n            <a href=\"?locale=en\">English</a>\n          </div>\n        </header>\n        <Main />\n      </AppWrapper>\n    );\n  }\n}\n\nexport default connect(({ covid19 }) => ({\n  lastUpdateDate: covid19.data.lastUpdateDate,\n}))(withOrientationChange(injectIntl(App)));\n","import React, { Component } from 'react';\nimport { IntlProvider } from 'react-intl';\nimport translations from './i18n/locales';\nimport App from './App';\n\nclass AppIntlWrapper extends Component {\n  render() {\n    const locale = window.location.search.replace('?locale=', '') || 'es';\n    const messages = translations[locale];\n    return (\n      <IntlProvider locale={locale} key={locale} messages={messages}>\n        <App />\n      </IntlProvider>\n    );\n  }\n}\n\nexport default AppIntlWrapper;\n","import { createGlobalStyle } from 'styled-components';\n\nexport const GlobalStyle = createGlobalStyle`\n  body {\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n`;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { store } from './redux';\nimport AppIntlWrapper from './AppIntlWrapper';\n\nimport { GlobalStyle } from './styles/Index.js';\n\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <GlobalStyle />\n    <Provider store={store}>\n      <AppIntlWrapper />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}